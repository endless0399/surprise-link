<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>For Poorvi ‚ù§Ô∏è</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { --pink: #ff4081; --bg: #ffebee; }
        * { touch-action: manipulation; -webkit-tap-highlight-color: transparent; }
        body { 
            margin: 0; background: var(--bg); 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex; justify-content: center; align-items: center; min-height: 100vh;
            overflow: hidden; 
        }
        .card { 
            background: white; padding: 25px; border-radius: 20px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); width: 320px; text-align: center;
            z-index: 10;
        }
        .hidden { display: none; }
        h1 { color: #d32f2f; margin-bottom: 10px; font-size: 1.4rem; }
        
        /* Maze Area */
        #maze-area { position: relative; width: 300px; height: 150px; background: var(--pink); margin: 20px auto; border-radius: 15px; overflow: hidden; }
        .path { position: absolute; background: white; top: 40px; left: 0; width: 300px; height: 70px; z-index: 1; }
        .actor-container { position: absolute; display: flex; flex-direction: column; align-items: center; z-index: 10; }
        .actor-label { font-size: 10px; font-weight: bold; color: var(--pink); margin-bottom: -5px; }
        .actor-icon { font-size: 25px; }
        #player-container { top: 45px; left: 10px; transition: all 0.2s ease; }
        #goal-container { top: 45px; right: 10px; }

        /* Love Meter */
        #love-prompt { font-weight: bold; color: #d81b60; margin-bottom: 5px; font-size: 1.1rem; }
        .bar-container { width: 100%; height: 25px; background: #eee; border-radius: 15px; margin: 20px 0; overflow: hidden; border: 2px solid #f8bbd0; }
        #fill { width: 0%; height: 100%; background: var(--pink); transition: width 0.1s linear; }
        #heart-btn { font-size: 4.5rem; cursor: pointer; user-select: none; display: inline-block; transition: transform 0.1s ease; }
        #heart-btn:active { transform: scale(1.2); }

        /* Catch Game */
        #game-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #ff80ab; display: none; flex-direction: column; align-items: center; z-index: 1000; }
        #bucket { position: absolute; bottom: 50px; font-size: 5rem; transition: left 0.15s ease-out; }
        .kiss { position: absolute; font-size: 2.5rem; }

        /* Final Page */
        #scratch-container { position: relative; width: 280px; height: 280px; margin: 0 auto; border-radius: 15px; overflow: hidden; border: 4px solid var(--pink); }
        #scratch-canvas { position: absolute; top: 0; left: 0; z-index: 20; touch-action: none; }
        .couple-img { width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0; z-index: 1; }
        #spoiler-box { background: #333; color: white; padding: 10px; margin-top: 15px; border-radius: 10px; cursor: pointer; font-weight: bold; transition: all 0.3s; }
        .revealed { background: transparent !important; color: #d32f2f !important; font-size: 1.3rem !important; }
        button { width: 100%; padding: 12px; margin-top: 10px; border-radius: 10px; border: none; background: var(--pink); color: white; font-weight: bold; cursor: pointer; font-size: 1rem; }
        .btn-opt { background: #fce4ec; color: #d81b60; border: 1px solid #f8bbd0; margin-bottom: 8px; font-size: 0.9rem; }
        #yes-btn { background: #4caf50; display: none; }
    </style>
</head>
<body oncontextmenu="return false;">

    <div id="lvl0" class="card">
        <h1>Hi Poorvi! ‚ù§Ô∏è</h1>
        <p>Siddharth has a special quest for you. Let's see how intelligent you are</p>
        <button onclick="go(1)">Start Quest</button>
    </div>

    <div id="lvl1" class="card hidden">
        <h1>Challenge 1: The Path</h1>
        <p>Tap the white path to move Poorvi to Siddharth!</p>
        <div id="maze-area" onclick="handleMazeTap(event)">
            <div class="path"></div>
            <div id="player-container" class="actor-container">
                <span class="actor-label">Poorvi</span>
                <span class="actor-icon">üèÉ‚Äç‚ôÄÔ∏è</span>
            </div>
            <div id="goal-container" class="actor-container">
                <span class="actor-label">Siddharth</span>
                <span class="actor-icon">üôã‚Äç‚ôÇÔ∏è</span>
            </div>
        </div>
    </div>

    <div id="lvl2" class="card hidden">
        <h1>Challenge 2: Memory</h1>
        <p id="qText" style="font-weight:bold; padding: 5px;"></p>
        <div id="qOpts"></div>
    </div>

    <div id="lvl3" class="card hidden">
        <h1>Challenge 3: Love Meter</h1>
        <p id="love-prompt">Fill your love for Siddharth</p>
        <div id="heart-btn" onclick="tapHeart()">‚ù§Ô∏è</div>
        <div class="bar-container"><div id="fill"></div></div>
    </div>

    <div id="game-screen" onclick="moveBucket(event)">
        <h1 style="color:white; margin-top: 50px; text-shadow: 2px 2px 4px rgba(0,0,0,0.2); text-align: center; padding: 0 10px;">
            Tap to catch 5 kisses from Siddharth!<br>Score: <span id="score">0</span>
        </h1>
        <div id="bucket" style="left: 50%;">üß∫</div>
    </div>

    <div id="lvl5" class="card hidden">
        <h2 style="color:var(--pink); margin-bottom: 10px;">Happy Propose Day! üíç‚ú®</h2>
        <div id="scratch-container">
            <img src="our-photo.jpeg" class="couple-img">
            <canvas id="scratch-canvas" width="280" height="280"></canvas>
        </div>
        <div id="spoiler-box" onclick="revealQuestion(this)">Click to see a secret message...</div>
        <button id="yes-btn" onclick="celebrate()">Yes, I will! ‚ù§Ô∏è</button>
        <p style="font-weight:bold; color:#d32f2f; margin-top: 15px;">Poorvi ‚ù§Ô∏è Siddharth</p>
    </div>

    <script>
        let lastTouchEnd = 0, luv = 0, luvInterval, step = 0, score = 0;

        function revealQuestion(el) { el.innerText = "Will you be my Valentine? üåπ"; el.classList.add('revealed'); document.getElementById('yes-btn').style.display = 'block'; }
        
        function celebrate() {
            const duration = 5 * 1000; const end = Date.now() + duration;
            (function frame() {
              confetti({ particleCount: 3, angle: 60, spread: 55, origin: { x: 0 }, colors: ['#ff4081', '#d32f2f'] });
              confetti({ particleCount: 3, angle: 120, spread: 55, origin: { x: 1 }, colors: ['#ff4081', '#d32f2f'] });
              if (Date.now() < end) requestAnimationFrame(frame);
            }());
            alert("Siddharth is the luckiest guy! Happy Propose Day Poorvi! ‚ù§Ô∏è");
        }

        function go(n) {
            document.querySelectorAll('.card, #game-screen').forEach(el => el.style.display = 'none');
            const target = (n === 4) ? document.getElementById('game-screen') : document.getElementById('lvl' + n);
            if (n === 4) target.style.display = 'flex'; else target.style.display = 'block';
            if(n === 2) loadQ(); if(n === 3) startLuvDrain(); if(n === 4) initCatch(); if(n === 5) initScratch();
        }

        function handleMazeTap(e) {
            const rect = document.getElementById('maze-area').getBoundingClientRect();
            const x = e.clientX - rect.left, y = e.clientY - rect.top, player = document.getElementById('player-container');
            if (y < 40 || y > 110) { player.style.left = "10px"; } 
            else { player.style.left = (x - 25) + "px"; if (x > 250) go(2); }
        }

        const qs = [
            { q: "Poorvi, where did we meet first?", o: ["Park üå≥", "Hospital üè•", "School üè´"], a: "Hospital üè•" },
            { q: "What was the first gift Siddharth gave you?", o: ["Teddy Bear üß∏", "Octopus üêô", "Chocolates üç´", "Flowers üíê"], a: "Octopus üêô" },
            { q: "What do you like about Siddharth?", o: ["Intelligent üß†", "Caring ü´Ç", "Kind ‚ú®", "All of the above ‚ù§Ô∏è"], a: "All of the above ‚ù§Ô∏è" },
            { q: "How much do you love him?", o: ["A lot! ü•∞", "Infinity + 1 ‚ôæÔ∏è", "Unconditionally üåé", "To the moon & back üåô", "More than he loves me üò§"], a: null }
        ];

        function loadQ() {
            const data = qs[step]; document.getElementById('qText').innerText = data.q;
            const div = document.getElementById('qOpts'); div.innerHTML = '';
            data.o.forEach(opt => {
                const b = document.createElement('button'); b.innerText = opt; b.className = 'btn-opt';
                b.onclick = () => { if(!data.a || opt === data.a) { step++; if(step < qs.length) loadQ(); else go(3); } else { alert("Try again, sweetheart ‚ù§Ô∏è"); } };
                div.appendChild(b);
            });
        }

        function startLuvDrain() { luvInterval = setInterval(() => { if (luv > 0) { luv -= 0.8; updateBar(); } }, 100); }
        function tapHeart() { luv += 12; if (luv >= 100) { luv = 100; updateBar(); clearInterval(luvInterval); setTimeout(() => go(4), 300); } updateBar(); }
        function updateBar() { document.getElementById('fill').style.width = luv + '%'; }

        function moveBucket(e) { const bucket = document.getElementById('bucket'), x = e.clientX || (e.touches && e.touches[0].clientX); bucket.style.left = x + 'px'; bucket.style.transform = 'translateX(-50%)'; }

        function initCatch() {
            const gameInt = setInterval(() => {
                if(score >= 5) { clearInterval(gameInt); go(5); return; }
                const k = document.createElement('div'); k.className = 'kiss'; k.innerHTML = 'üíã';
                k.style.left = Math.random() * (window.innerWidth - 40) + 'px'; k.style.top = '-50px';
                document.getElementById('game-screen').appendChild(k);
                let y = -50;
                const fall = setInterval(() => {
                    y += 6; k.style.top = y + 'px';
                    const br = document.getElementById('bucket').getBoundingClientRect(), kr = k.getBoundingClientRect();
                    if(kr.bottom >= br.top && kr.right >= br.left && kr.left <= br.right) { score++; document.getElementById('score').innerText = score; clearInterval(fall); k.remove(); }
                    if(y > window.innerHeight) { clearInterval(fall); k.remove(); }
                }, 20);
            }, 900);
        }

        function initScratch() {
            const canvas = document.getElementById('scratch-canvas'), ctx = canvas.getContext('2d');
            ctx.fillStyle = '#C0C0C0'; ctx.fillRect(0, 0, 280, 280);
            ctx.fillStyle = '#666'; ctx.font = '16px Arial'; ctx.textAlign = 'center'; ctx.fillText('Tap & rub to reveal ‚ù§Ô∏è', 140, 140);
            let isDrawing = false;
            const scratch = (e) => {
                if (!isDrawing) return;
                const rect = canvas.getBoundingClientRect(), x = (e.clientX || (e.touches && e.touches[0].clientX)) - rect.left, y = (e.clientY || (e.touches && e.touches[0].clientY)) - rect.top;
                ctx.globalCompositeOperation = 'destination-out'; ctx.beginPath(); ctx.arc(x, y, 25, 0, Math.PI * 2); ctx.fill();
            };
            canvas.addEventListener('mousedown', () => isDrawing = true); canvas.addEventListener('mouseup', () => isDrawing = false);
            canvas.addEventListener('mousemove', scratch); canvas.addEventListener('touchstart', () => isDrawing = true); canvas.addEventListener('touchend', () => isDrawing = false); canvas.addEventListener('touchmove', (e) => scratch(e));
        }

        document.addEventListener('touchend', (e) => { let now = (new Date()).getTime(); if (now - lastTouchEnd <= 300) e.preventDefault(); lastTouchEnd = now; }, false);
    </script>
</body>
</html>
